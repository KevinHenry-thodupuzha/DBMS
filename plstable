CREATE TABLE Bill (
    cust_no NUMBER PRIMARY KEY,
    units_consumed NUMBER,
    amount FLOAT
);
CREATE OR REPLACE FUNCTION calculate_bill(p_cust_no NUMBER, p_units NUMBER)
RETURN FLOAT
IS
    v_amount FLOAT := 0;
BEGIN
    -- Calculate bill using slab rates
    IF p_units <= 100 THEN
        v_amount := p_units * 1;
    ELSIF p_units <= 200 THEN
        v_amount := 100 * 1 + (p_units - 100) * 2;
    ELSE
        v_amount := 100 * 1 + 100 * 2 + (p_units - 200) * 3;
    END IF;

    -- Insert the record into the Bill table
    INSERT INTO Bill(cust_no, units_consumed, amount)
    VALUES (p_cust_no, p_units, v_amount);

    -- Return the calculated amount
    RETURN v_amount;

EXCEPTION
    WHEN DUP_VAL_ON_INDEX THEN
        DBMS_OUTPUT.PUT_LINE('Customer number already exists!');
        RETURN 0;
END calculate_bill;
/


DECLARE
    v_bill FLOAT;
BEGIN
    v_bill := calculate_bill(101, 250);  -- Customer 101 used 250 units
    DBMS_OUTPUT.PUT_LINE('Electricity bill for customer 101: ' || v_bill);
END;
/